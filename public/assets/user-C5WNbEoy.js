import{s as c,A as l}from"./app-CBNaHwnX.js";const g=c("user",{state:()=>({users:[],currentUser:null,loading:!1,error:null,pagination:{currentPage:1,lastPage:1,perPage:15,total:0},filters:{search:"",role:"",sort_by:"created_at",sort_order:"desc"}}),getters:{adminUsers:s=>s.users.filter(t=>{var e;return(e=t.roles)==null?void 0:e.includes("admin")}),regularUsers:s=>s.users.filter(t=>{var e;return(e=t.roles)==null?void 0:e.includes("user")}),getUserById:s=>t=>s.users.find(e=>e.id===t)},actions:{async fetchUsers(s=1){var t,e;this.loading=!0,this.error=null;try{const r={page:s,per_page:this.pagination.perPage,...this.filters};Object.keys(r).forEach(o=>{(r[o]===""||r[o]===null)&&delete r[o]});const a=await l.list(r);return this.users=a.data.data,this.pagination={currentPage:a.data.meta.current_page,lastPage:a.data.meta.last_page,perPage:a.data.meta.per_page,total:a.data.meta.total},a.data}catch(r){throw this.error=((e=(t=r.response)==null?void 0:t.data)==null?void 0:e.message)||"Error al cargar usuarios",r}finally{this.loading=!1}},async fetchUser(s){var t,e;this.loading=!0,this.error=null;try{const r=await l.get(s);return this.currentUser=r.data.data,r.data.data}catch(r){throw this.error=((e=(t=r.response)==null?void 0:t.data)==null?void 0:e.message)||"Error al cargar usuario",r}finally{this.loading=!1}},async updateUser(s,t){var e,r,a,o,d;this.loading=!0,this.error=null;try{const i=await l.update(s,t),n=this.users.findIndex(u=>u.id===s);return n!==-1&&(this.users[n]=i.data.data),((e=this.currentUser)==null?void 0:e.id)===s&&(this.currentUser=i.data.data),i.data}catch(i){if(this.error=((a=(r=i.response)==null?void 0:r.data)==null?void 0:a.message)||"Error al actualizar usuario",(d=(o=i.response)==null?void 0:o.data)!=null&&d.errors){const n=i.response.data.errors,u=Object.values(n).flat().join(", ");this.error=u}throw i}finally{this.loading=!1}},async deleteUser(s){var t,e;this.loading=!0,this.error=null;try{return await l.delete(s),this.users=this.users.filter(r=>r.id!==s),this.pagination.total--,!0}catch(r){throw this.error=((e=(t=r.response)==null?void 0:t.data)==null?void 0:e.message)||"Error al eliminar usuario",r}finally{this.loading=!1}},setFilters(s){this.filters={...this.filters,...s}},clearFilters(){this.filters={search:"",role:"",sort_by:"created_at",sort_order:"desc"}},clearCurrentUser(){this.currentUser=null}}});export{g as u};
